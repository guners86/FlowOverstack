<div class="container">
  <div class="row">
    <div class="col-sm-10 col-sm-offset-1">
      <div class="questions">
      	
      	<h1><%= @question.title %></h1>
      	
      	<div class="question-summary">
      	  <div class="cp">
      	    
      	    <div class="question-votes">
      	      <div class="mini-count">
      	        
      	        <% if @question.voted_by? current_user %>
      	          <%= link_to question_vote_path(@question, :commentable_type => "Question", :commentable_id => @question.id), method: :delete, class: "product-upvote upvote-active" do %>
                    <span class="upvote-arrow"></span>
                    <span class="upvote-count"><%= @question.votes.count %></span>
                  <% end %>
                <% else %>
                  <%= link_to question_vote_path(@question, :commentable_type => "Question", :commentable_id => @question.id), method: :post, class: "product-upvote" do %>
                    <span class="upvote-arrow"></span>
                    <span class="upvote-count"><%= @question.votes.count %></span>
                  <% end %>
                <% end %>
      	        
      	      </div>
      	      <div>Votos</div>
      	    </div>
      	  </div>
      	  
      	  <div class="summary">
            <span class="question-description"><%= @question.body %></span>
          </div>
      	</div>
        
        <h2>(<%= @question.comments.count %>) Comentario(s)</h2>
        
        <% @question.comments.each do |comment| %>
            <div class="panel panel-default">
                <div class="panel-body">
                  <span class="question-title"><%= comment.body %></span>
                  <span class="question-description">Comentario realizado por <%= comment.user.name %></span>
                  <p></p>
                </div>
            </div>
        <% end %>
        
        <% if signed_in? %>
            <%= form_for [@question, @question.comments.build] do |f| %>
                <div class="form-group">
                  <%= f.text_area :body, class: "form-control", placeholder: "Agregar Comentario" %>
                  <%= f.hidden_field :commentable_type, value: "Question" %>
                  <%= f.hidden_field :commentable_id, value: @question.id %>
                </div>
        
                <div class="actions text-right">
                  <%= f.submit "Comentar", class: "btn btn-primary" %>
                </div>
            <% end %>
        <% end %>
        
        <h2>(<%= @question.answers.count %>) Respuesta(s)</h2>
        
        <% @question.answers.each do |answer| %>
            <div class="panel panel-default">
                <div class="panel-body"><%= answer.body %></div>
                
                <% answer.comments.each do |comment| %>
                  <div class="panel panel-default">
                      <div class="panel-body">
                        <span class="question-title"><%= comment.body %></span>
                        <span class="question-description">Comentario realizado por <%= comment.user.name %></span>
                        <p></p>
                      </div>
                  </div>
                <% end %>
                
                <% if signed_in? %>
                  <%= form_for [answer, answer.comments.build] do |f| %>
                    <div class="form-group">
                      <%= f.text_area :body, class: "form-control", placeholder: "Agregar Comentario" %>
                      <%= f.hidden_field :commentable_type, value: "Answer" %>
                      <%= f.hidden_field :commentable_id, value: answer.id %>
                    </div>
                
                    <div class="actions text-right">
                      <%= f.submit "Comentar", class: "btn btn-primary" %>
                    </div>
                  <% end %>
                <% end %>
                
            </div>
        <% end %>
        
        <% if signed_in? %>
            <%= form_for [@question, @question.answers.build] do |f| %>
                <div class="form-group">
                  <%= f.text_area :body, class: "form-control", placeholder: "Agregar Respuesta" %>
                </div>
        
                <div class="actions text-right">
                  <%= f.submit "Responder", class: "btn btn-primary" %>
                </div>
            <% end %>
        <% end %>
        
      </div>
    </div>
  </div>
</div>